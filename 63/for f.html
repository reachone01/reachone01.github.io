<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<title>for f</title>

 <style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}

.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:5px;
margin-bottom:-15px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color:#eee;
color:#000;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 105px;
_bottom: "auto";
cursor: pointer;
opacity: .6;
filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 30px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 80px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 55px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
 
 img{
 border:0;
 }
 #tab1{
 width:100%;
 border-collapse:collapse;
 
 }
 #tab1 td{
 border:1px blue solid;
 }
#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	
	table-layout:fixed;
	font-size:18px;
}

#tbrowser th,#tbrowser td{
border:1px solid #eee;
font-size:14px;
color:#000000;

font-family: "宋体";
padding-left:0px;
width:14.1%;

height:22px;
line-height:18px;
/*overflow:hidden;
white-space:nowrap;*/
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
/*padding:2px 0px;*/
display:table-column-group;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
background-color:#f2f4b9;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;

/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/

/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;

/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;

/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;

line-height:18px;
font-size:16px;
color:#777;
}
.ph{
text-indent:4em;
color:blue;
line-height:18px;
}
p{
text-indent:2em;
}table{
border-collapse:collapse;
width:88%;
margin:auto;
}
table td{
border:0px;
border:1px solid #aaa;
padding:4px;}
h2{
padding-bottom:22px;}
 </style>
</head>

<body>




<div class="container">

  <p>文本的立体解析，用一个或数个变量逐行进行，可以理解为行列式、二维数组、字段记录的关系数据、excel数据列；文本可来源于文件、文本串或命令的输出； <br />
    /F  parsing file content and command output or text;<br />
    for  /f &quot;tokens=*&quot; %%a in ('dir') do ( command[command-parameters])<br />
    for循环语句用于分析&quot;dir&quot;命令所显示的字符串，&quot;/f&quot;参数表示for语句以解析方式工作。For语句首先执行括号中&quot;dir&quot;命令，然后进入for语句块执行相应的命令。&quot;tokens&quot;参数只有一个&quot;*&quot;,表示&quot;%%a&quot;将依次代表&quot;dir&quot;命令输出的每一行。For语句循环次数等于&quot;dir&quot;命令显示结果的行数。 <br />
  <h2>格式说明1     </h2>
    FOR /F [&quot;options useabckq&quot;]  %variable IN (&quot;file-set&quot;) DO command [command-parameters]<br />
    FOR  /F [&quot;options&quot;] %variable IN ('string') DO command  [command-parameters]<br />
    FOR  /F [&quot;options&quot;] %variable IN (`command`) DO command  [command-parameters](注意符号是`,esc 下的符号） <br />
    fileset 为一个或多个文件名(以空格分隔）。继续到  fileset 中的下一个文件之前，每份文件都被打开、读取并经过处理。处理包括读取文件，将其分成一行行的文字，忽略空行，然后将每行解析成零或更多的符号。然后用已找到的符号字符串变量值调用 For 循环.<br />
    <br /><br />

    <h2>格式说明2     </h2>
    for /f [&quot;optins&quot;] %%var in  (&quot;file-set&quot;) do command[command-parameters]<br />
    for  /f [&quot;optins&quot;] %%var in ('string') do command[command-parameters]<br />
    for  /f [&quot;optins&quot;] %%var in (`command`) do command[command-parameters]<br />
    如果&quot;optins&quot;指定的选项中包含usebackq,则filename为一个或多个文件名.继续到filenameset中的下一个文件之前,每份文件都已被打开,读取并经过处理.处理包括读取文件,将其分成单行的文字,然后将每行解析成符号.然后用已找到的符号字符串变量值调用for循环.<br />
    默认情况下,/f通过每个文件的每一行中分开的第一个空白符号.路过空白行.<br />
    用户可以通过指定可选&quot;optins&quot;参数替代默认解析操作.这个带引号的字符串可以包括一个或多个指定不同解析选项的关键字:<br />
    <br />
    <strong>格式说明3</strong><br />
for /f [&quot;options&quot;] %%var in  (source) do statement<br />
    options用于设置文本匹配选项;<br />
    source指定了文本的来源;<br />
    statement  指定了在文本匹配时要执行的操作;<br />
    source中的每一行文本被当做一个记录进行处理,不同的字段由特定的字符分隔开(默认的分隔符是制表符和空格);<br />
    <br />
    <strong>例1 </strong><br />
    for /f &quot;eol=; tokens=2,3* delims=,  &quot; %%i in (coolpen.txt) do @echo %i %j %k<br />
    /f  该语句会分析coolpen.txt中的每一行,<br />
    eol=;  忽略以;打头的那些行;<br />
    tokens=2,3*将每行的第二个和第三个符号传递给for函数体;即截取第二列、第三列、第三列后面的列，第二列由%%i表示，第三列由i的下一个字母k,即变量%%j表示，剩下的部分下%%k表示； <br />
    delims=,用逗号和空格分隔符号.<br />
    对于带有空格的文件名,用户需要用双括号将文件名括起来.为了用这种方式来使用双引号,还需要使用usebackq选项,否则,双引用会被理解成是用作定义某个要分析的字符串;<br />
    %i是for语句中的声明,%j,%k是通过tokens=选项隐式声明的.可以通过tokens=一行指定最多26个符号,<br />
    for变量是一个单一字母,分大小写和全局的变量;<br />
    <br />
    <strong>例2 </strong><br />
    如有一个文本文档wwu.txt,其内容是:wu wanqun w\h staff wwuhn@hotmail.com 13725317945<br />
    如果将该行看成一个记录,可以划分为6个字段;<br />
    for  /f &quot;tokens=1-6&quot; %%a in (wwu.txt) do (@echo name: %%a %%b department:  %%c place: %%d email: %%e tel: %%f<br />
    该命令指定了要处理的前6个字段,分别由%%A代表第一个字段,依次下次;<br />
    eol:设置行尾注注释字段,此外的所有数据都被命令看成注释;<br />
    tokens:为每一源行设置令牌字段,默认情况下,只对第一个令牌进行检查;<br />
    usebackq:规定可以在源指定符号中使用引号,也就是in ()这一部分:对文件名使用双引号,对命令使用反引号(即反引号用于封装命令,与~现一个键);对字符串封装用单引号;<br />
    tokens:*:把一行当作整体处理,而不分割为字段;<br />
    <br />
    <strong>option:可以是以下的一个或多个组合;</strong><br />
    以默认方式，/F 通过每个文件的每一行中分开的第一个空白符号。跳过空白行。 <br />
    您可通过指定可选  &quot;options&quot; 参数替代默认解析操作。这个带引号的字符串包括一个或多个指定不同解析选项的关键字。这些关键字为:<br />
    <br />
    <strong>关于行的选项</strong> <br />
    tokens:*:把一行当作整体处理,而不分割为字段;<br />
    token  fields sparated by spaces or tabs by default<br />
    eol=c:指定一个行注释字符的结尾(仅一个);<br />
    eol=c           - 指一个行注释字符的结尾(就一个)（忽略指定字符开头的行）； <br />
    skip=n:在文件开始时忽略的行数;<br />
    skip=n          - 指在文件开始时忽略的行数。 <br />
    <br />
    <strong>关于列或字段的选项</strong> <br />
    lelims=xxx:指定分隔符集.这个替换了空格和跳格键的默认分隔符集;<br />
    delims=xxx - 指分隔符集。这个替换了空格和跳格键的 默认分隔符集。可以是多个，以空格分隔，如果包括空格，要放置到最后；如果不考虑空格，则&quot;delims=&quot;<br />
    tokens=x,y,m-n:指每行的哪一个符号被传递到每个迭代的for本身.这会导致额外变量名称的分配.m-n格式为一个范围.<br />
    token:表示, 向征, 记号, 代币 <br />
    delimit定界限, 划界 <br />
    tokens=x,y,m-n  - 指每行的哪一个符号被传递到每个迭代的  for 本身。这会导致额外变量名称的分配。m-n格式为一个范围。通过 nth 符号指定 mth。如果符号字符串中的最后一个字符星号，那么额外的变量将在最后一个符号解析之后分配并接受行的保留文本。 <br />
    通俗地说，是指筛选列号，每行的文本通过分隔符delims分隔后，会生成若干列，这些列可以筛选使用，如果假设用分隔符分隔出了9列，用tokens指定的3列，在命令中使用的变量是%d,则还会扩充3－1个变量迭代其余两列（%d只表示tokens首先指定的列；最后的结果是形成一个行列式，或二维数组；行数＝总行数-空行-eol-skip;列数是由tokens指定的列数，指定了n列则有有%variable开始的n个变量来表示，每个变量的可能值的个数则是行数； <br />
    <br />
    usebackq - 指定新语法已在下类情况中使用:在作为命令执行一个后引号的字符串并且一个单引号字符为文字字符串命令并允许在 file-set中使用双引号扩起文件名称。</p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="shangy"><a href="javascript:void(null)" onclick="shangy()" target="_self">&uarr;</a></div>
<div id="xiay"><a href="javascript:void(null)" onclick="xiay()" target="_self">&darr;</a></div>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
<script type="text/javascript">
function xiay(){
window.scrollBy(0,window.innerHeight);
}
function shangy(){
window.scrollBy(0,-window.innerHeight);
}
</script>
</body>
</html>
