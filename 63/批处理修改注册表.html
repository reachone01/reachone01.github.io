<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<script type="text/javascript">
 
 function goTopEx(){
var obj=document.getElementById("goTopBtn");
function getScrollTop(){
return document.documentElement.scrollTop;
}
function setScrollTop(value){
document.documentElement.scrollTop=value;
}
window.onscroll=function(){getScrollTop()>0?obj.style.display="":obj.style.display="none";}
obj.onclick=function(){
var goTop=setInterval(scrollMove,10);
function scrollMove(){
setScrollTop(getScrollTop()/111);
if(getScrollTop()<1)clearInterval(goTop);
}
}
}


</script>
<title>批处理修改注册表</title>

 <style type="text/css">
#tbrowser a:link，.container a:visited{
font-size:18px;
text-decoration:none;
}
.container{
font-size:1.2em;
margin:auto;
font-family:"宋体";
width:75.29%;
line-height:1.4em;
}

.uls{
color:#CC6666;
font-weight:bold;
}
.uls>ol{
list-style:none;
font-weight:normal;
list-style:lower-latin;
color:#000000;
line-height:1.3em;

}
h2{
font-size:20px;
font-weight:bold;
margin-top:5px;
margin-bottom:-15px;
text-indent:0em;
}
img{
margin-right:5px;
}
.fc{
color:red;
}

a:link {
	text-decoration: none;
}


a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}


#goTopBtn {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color:#eee;
color:#000;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 105px;
_bottom: "auto";
cursor: pointer;
opacity: .6;
filter: Alpha(opacity=30);
	opacity=.3;
}
 #goTopBtn:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 
 
#goBottom {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 30px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
	writing-mode:tb-rl;
}
 #goBottom:hover{
 background-color:white;
 border:#ccc 1px solid;
 color:red;
 }
 #shangy {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 80px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
#xiay {
	width: 18px;
line-height: 1.2;
padding: 5px 0;
background-color: #eee;
color: #fff;
font-size: 12px;
text-align: center;
position: fixed;
_position: absolute;
 
right: 10px;
bottom: 55px;
_bottom: "auto";
cursor: pointer;
filter: Alpha(opacity=30);
	opacity=.3;
}
 
 img{
 border:0;
 }
 #tab1{
 width:100%;
 border-collapse:collapse;
 
 }
 #tab1 td{
 border:1px blue solid;
 }
#tbrowser {
	width:100%;
	margin:auto;
	border-collapse:collapse;
font-family:"宋体";
	
	table-layout:fixed;
	font-size:18px;
}

#tbrowser th,#tbrowser td{
border:1px solid #eee;
font-size:14px;
color:#000000;

font-family: "宋体";
padding-left:0px;
width:14.1%;

height:22px;
line-height:18px;
/*overflow:hidden;
white-space:nowrap;*/
}


#tbrowser thead th{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
color:#fff;
/*padding:2px 0px;*/
display:table-column-group;
}
#tbrowser .nd{
border-bottom:2px solid #3d580b;
background-color:#8fc629;
background-color:#D3D3A9;
color:red;
}

#tbrowser th{
background-color:#f2f4b9;
}
#tbrowser th.title{
background-color:#e3e685;
}

#tbrowser caption{
font-weight:bold;
padding:1px 0px;
color:#3d580b;
font-size:18px;
}


#tbrowser .xhx{
border-bottom:0px solid #aaa;
}


#tbrowser tr{
height:6px;
}

#tbrowser tr>td{/*1*/
font-size:1em;

/*width:13%;*/
}
#tbrowser tr>td+td{/*2*/

/*width:8%;*/
font-size:1em;
}
#tbrowser tr>td+td+td{/*3*/
font-size:1em;
/*width:5%;*/
}
#tbrowser tr>td+td+td+td{/*4*/
font-size:1em;

/*width:6%;*/
}
#tbrowser tr>td+td+td+td+td{/*5*/
font-size:1em;

/*width:5%;*/
}
#tbrowser tr>td+td+td+td+td+td{/*6*/
/*width:13%;*/
font-size:1em;
}
#tbrowser tr>td+td+td+td+td+td+td{/*7*/
/*width:59%;*/
font-size:1em;
}


#tbrowser tfoot td{
border-width:0px;

line-height:18px;
font-size:16px;
color:#777;
}
.ph{
text-indent:4em;
color:blue;
line-height:18px;
}
</style>
</head>

<body>
<div class="container">



<div id="container">
  <p>.reg文件1<br />
    Windows Registry Editor Version 5.00<br />
    [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]<br />
    Start=dword:00000004</p>
  <p>.reg文件2<br />
    Windows Registry Editor Version 5.00<br />
    [HKEY_CURRENT_USER\Software\Microsoft\Internet  Explorer\Main]<br />
    Start Page=&quot;www.baidu.com&quot;</p>
  <p>.bat文件1<br />
    @reg add  &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; /v  Start /t REG_DWORD /d 00000004 /f</p>
  <p>.bat文件2<br />
    @reg add  &quot;HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main&quot; /v  &quot;Start Page&quot; /d &quot;http://www.baidu.com&quot; /f</p>
  <p>reg add /?<br />
    /v        所选项之下要添加的字符串数值名称，如 Start Page<br />
    /d        要分配给添加的注册表 ValueName 的数值数据，如 http://www.baidu.com<br />
    /f        不用提示就强行改写现有注册表项 <br />
    /t       RegKey 数据类型 <br />
    字符串值REG_SZ、多字符串值REG_MULTI_SZ<br />
    DWORD值REG_DWORD、  二进制值REG_BINARY<br />
    可扩充字符串值REG_EXPAND_SZ<br />
    如果忽略，则采用 REG_SZ<br />
    <br />
    /ve      为注册表项添加空白值名&lt;无名称&gt;<br />
    /s       指定一个在 REG_MULTI_SZ 数据字符串中 <br />
    用作分隔符的字符 <br />
    如果忽略，则将 &quot;\0&quot; 用作分隔符 </p>
  <p>例如:<br />
    REG  ADD \\ABC\HKLM\Software\MyCo<br />
    添加远程机器 ABC 上的一个注册表项  HKLM\Software\MyCo</p>
  <p> REG  ADD HKLM\Software\MyCo /v Data /t REG_BINARY /d fe340ead<br />
    添加一个值(名称: Data，类型:  REG_BINARY，数据: fe340ead)</p>
  <p> REG  ADD HKLM\Software\MyCo /v MRU /t REG_MULTI_SZ /d fax\0mail<br />
    添加一个值(名称: MRU，类型:  REG_MUTLI_SZ，数据: fax\0mail\0\0)</p>
  <p> REG  ADD HKLM\Software\MyCo /v Path /t REG_EXPAND_SZ /d %%systemroot%%<br />
    添加一个值(名称: Path，类型:  REG_EXPAND_SZ，数据: %systemroot%)<br />
    注意:  在扩充字符串中使用双百分比符号( %% )</p>
  <h2>批处理操作注册表</h2>
  <p>一、reg query<br />
    查询某注册表项或值 <br />
    1.reg query keyname /v valuename<br />
    显示valuename的值。 <br />
    比喻，我现在想查看我这系统是注册给哪个用户（系统属性里面的注册到..下面） <br />
    可输入 </p>
  <p>reg query  &quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot; /v  &quot;RegisteredOwner&quot;</p>
  <p>在结果中，REG_SZ 后面的就是注册用户了，如果想查询后直接显示注册用户而不显示多余信息，可结合for来实现 </p>
  <p>@for /f &quot;tokens=3 skip=4&quot; %i in  ('reg query &quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot; /v  &quot;RegisteredOwner&quot;') do @echo 注册用户名是：%i</p>
  <p>结果就显示了，注册用户名是：用户名 </p>
  <p>2.reg query keyname /ve<br />
    查询默认值或空白值的名称。 </p>
  <p>这个较少用，因为一般的默认值都是  数值未设置 </p>
  <p>3.reg query keyname /s<br />
    查询所有子项和值。 </p>
  <p>和1一样，但这个查询的是整个子项和该项下的值 </p>
  <p>二、reg add<br />
    添加注册表项 <br />
    reg add keyname [/v valuename] [/t 类型] [/d 数据] [/f 不提示强行修改]<br />
    例： REG ADD HKLM\Software\MyCo /v Data /t REG_BINARY /d fe340ead<br />
    添加一个值(名称: Data，类型: REG_BINARY，数据: fe340ead)</p>
  <p>添加或是修改某个存在的注册表项 <br />
    参数 /v /t /d 位置不能调换，否则报错，/f可在 /v 前或是/d 后 </p>
  <p>如，修改注册用户名为 morning ，可输入 </p>
  <p>reg add  &quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot; /v &quot;RegisteredOwner&quot;  /t REG_SZ /d morning /f</p>
  <p>三、reg delete<br />
    删除注册表项和值 <br />
    reg delete keyname [/v vluename] [/f]</p>
  <p>如果不加 /v 参数，那么删除的是整个注册表项，如果加 /v 则删除该项下的 vluename 键 </p>
  <p>如：reg delete &quot;HKLM\Software\Microsoft\Windows  NT\CurrentVersion&quot;,结果就是删除整个 CurrentVersion 项 <br />
    若加上 /v reg delete &quot;HKLM\Software\Microsoft\Windows  NT\CurrentVersion&quot; /v &quot;RegisteredOwner&quot; 则删除的是  CurrentVersion 的键 RegisteredOwner</p>
  <p>四、reg copy <br />
    复制注册表的项和值 <br />
    reg copy 源 目标 [/s 复制所有子项和值] [/f  不提示，强行改写]</p>
  <p>和1差不多，只是将某个项或键的信息复制到另一个项或键上而已，跟文件的复制一样 </p>
  <p>五、reg import <br />
    导入注册表文件 <br />
    reg import *.reg</p>
  <p>也可以用 regedit /s *.reg 来导入注册表信息文件 </p>
  <p>六、reg export<br />
    导出到文件 <br />
    例： REG EXPORT HKLM\Software\MyCo\MyApp AppBkUp.reg<br />
    将注册表项 MyApp 的所有子项和值导出到文件 AppBkUp.reg<br />
    导出某个项或是键的信息 <br />
    如果要导出整个注册表，那就用 regedit /e 保存路径 </p>
  <p>sz:字符串； <br />
    Binary:二进制； <br />
    Dword:双字；</p>
</div>
<a name="bottom" id="bottom"></a>
<DIV style="DISPLAY: none" id=goTopBtn>&and;</DIV>
<div id="shangy"><a href="javascript:void(null)" onclick="shangy()" target="_self">&uarr;</a></div>
<div id="xiay"><a href="javascript:void(null)" onclick="xiay()" target="_self">&darr;</a></div>
<div id="goBottom"><a href="#bottom" target="_self">&or;</a></div>
<SCRIPT type=text/javascript>goTopEx();</SCRIPT>
<script type="text/javascript">
function xiay(){
window.scrollBy(0,window.innerHeight);
}
function shangy(){
window.scrollBy(0,-window.innerHeight);
}
</script>
</body>
</html>
